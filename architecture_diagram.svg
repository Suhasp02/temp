<svg xmlns="http://www.w3.org/2000/svg" width="1400" height="820" viewBox="0 0 1400 820" role="img" aria-label="DDS Framework Architecture Diagram">
  <defs>
    <linearGradient id="gradBlue" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#4F8EF7"/>
      <stop offset="100%" stop-color="#204ECF"/>
    </linearGradient>
    <linearGradient id="gradGreen" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#34C759"/>
      <stop offset="100%" stop-color="#1E7F36"/>
    </linearGradient>
    <linearGradient id="gradOrange" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#FFA94D"/>
      <stop offset="100%" stop-color="#FF6B00"/>
    </linearGradient>
    <linearGradient id="gradPurple" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#B197FC"/>
      <stop offset="100%" stop-color="#7048E8"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.25"/>
    </filter>
    <!-- Cylinder shape -->
    <g id="cylinder">
      <ellipse cx="0" cy="0" rx="120" ry="18" fill="#e9ecef" stroke="#5c677d" stroke-width="2"/>
      <rect x="-120" y="-100" width="240" height="100" fill="#f8f9fa" stroke="#5c677d" stroke-width="2"/>
      <ellipse cx="0" cy="-100" rx="120" ry="18" fill="#dee2e6" stroke="#5c677d" stroke-width="2"/>
    </g>
    <!-- Cloud shape -->
    <g id="cloud">
      <path d="M80 40c0-22 18-40 40-40 16 0 30 9 36 22 6-4 13-6 20-6 22 0 40 18 40 40 0 1 0 3 0 4 16 2 28 16 28 32 0 18-14 32-32 32H60C27 124 0 97 0 64 0 31 27 4 60 4c9 0 18 2 26 6-3 9-6 19-6 30z" fill="#e7f5ff" stroke="#339af0" stroke-width="2"/>
    </g>
    <!-- Laptop icon -->
    <g id="laptop">
      <rect x="-55" y="-35" width="110" height="70" rx="6" ry="6" fill="#212529"/>
      <rect x="-49" y="-29" width="98" height="58" rx="4" ry="4" fill="#000" stroke="#495057" stroke-width="2"/>
      <rect x="-48" y="-28" width="96" height="50" fill="#343a40"/>
      <rect x="-70" y="40" width="140" height="12" rx="6" ry="6" fill="#adb5bd"/>
    </g>
    <!-- Spark flame icon -->
    <g id="spark">
      <path d="M0 -40 C 20 -20, 40 -20, 28 0 C 36 0, 52 6, 40 16 C 54 18, 44 38, 26 30 C 20 44, 0 42, 0 26 C -10 36, -30 26, -20 12 C -36 12, -32 -10, -16 -10 C -26 -24, -6 -42, 0 -40 Z" fill="#ff922b" stroke="#d9480f" stroke-width="2"/>
    </g>
    <!-- Log file icon -->
    <g id="logfile">
      <rect x="-60" y="-80" width="120" height="160" rx="8" ry="8" fill="#fff4e6" stroke="#e8590c" stroke-width="2"/>
      <rect x="-40" y="-50" width="80" height="10" fill="#ffd8a8"/>
      <rect x="-40" y="-30" width="80" height="10" fill="#ffd8a8"/>
      <rect x="-40" y="-10" width="80" height="10" fill="#ffd8a8"/>
      <rect x="-40" y="10" width="80" height="10" fill="#ffd8a8"/>
    </g>
  </defs>

  <!-- Title -->
  <text x="700" y="48" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="28" fill="#212529">DDS Ingestion Framework – Pictorial Architecture</text>

  <!-- User -->
  <g transform="translate(120,150)" filter="url(#shadow)">
    <use href="#laptop"/>
    <text x="0" y="80" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="16" fill="#343a40">User</text>
    <text x="0" y="100" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="14" fill="#868e96">spark3-submit</text>
  </g>

  <!-- Launcher card -->
  <g transform="translate(420,130)" filter="url(#shadow)">
    <rect x="-150" y="-60" width="300" height="120" rx="12" fill="url(#gradBlue)"/>
    <text x="0" y="-18" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="18" fill="#ffffff">Launcher (bin/run_ingestion.py)</text>
    <text x="0" y="6" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="13" fill="#e7f5ff">Read /user/&lt;os_user&gt;/jobs.config</text>
    <text x="0" y="26" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="13" fill="#e7f5ff">Validate + unified log + call ingestion.run()</text>
  </g>

  <!-- HDFS config cloud -->
  <g transform="translate(420,310)" filter="url(#shadow)">
    <use href="#cloud"/>
    <text x="86" y="74" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="14" fill="#1971c2">HDFS: /user/&lt;os_user&gt;/jobs.config</text>
  </g>

  <!-- Arrow: User -> Launcher -->
  <path d="M220,150 C300,110 340,110 370,120" stroke="#343a40" stroke-width="2" fill="none" marker-end="url(#arrow)"/>

  <!-- Define arrow marker -->
  <defs>
    <marker id="arrow" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#343a40"/>
    </marker>
  </defs>

  <!-- Ingestion card with Spark flame -->
  <g transform="translate(860,130)" filter="url(#shadow)">
    <rect x="-180" y="-70" width="360" height="140" rx="12" fill="url(#gradOrange)"/>
    <g transform="translate(0,0)"><use href="#spark"/></g>
    <text x="0" y="36" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="18" fill="#fff3bf">Ingestion (dds_framework.ingestion_job)</text>
    <text x="0" y="58" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="13" fill="#fff3bf">SparkSession (Hive) • SQL-only CTAS/INSERT • Dyn. partitions</text>
  </g>

  <!-- Date dimension cylinder -->
  <g transform="translate(740,360)" filter="url(#shadow)">
    <use href="#cylinder"/>
    <text x="0" y="-130" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="16" fill="#212529">dds_meta.date_dim</text>
    <text x="0" y="-110" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="13" fill="#495057">MAX(biz_dt) by src_system/site_id</text>
  </g>

  <!-- Source view cylinder -->
  <g transform="translate(1020,360)" filter="url(#shadow)">
    <use href="#cylinder"/>
    <text x="0" y="-130" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="16" fill="#212529">Source Hive View</text>
    <text x="0" y="-110" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="13" fill="#495057">Filtered by src_system, site_id, biz_dt</text>
  </g>

  <!-- Target table cylinder -->
  <g transform="translate(1220,560)" filter="url(#shadow)">
    <use href="#cylinder"/>
    <text x="0" y="-130" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="16" fill="#212529">Target Hive Table</text>
    <text x="0" y="-110" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="13" fill="#495057">CTAS IF NOT EXISTS • INSERT</text>
  </g>

  <!-- Audit table cylinder -->
  <g transform="translate(860,560)" filter="url(#shadow)">
    <use href="#cylinder"/>
    <text x="0" y="-130" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="16" fill="#212529">default.dds_ingestion_audit</text>
    <text x="0" y="-110" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="13" fill="#495057">SQL-only INSERT</text>
  </g>

  <!-- Unified log file icon -->
  <g transform="translate(540,560)" filter="url(#shadow)">
    <use href="#logfile"/>
    <text x="0" y="100" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="14" fill="#343a40">Unified Log</text>
    <text x="0" y="118" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="12" fill="#868e96">logs/&lt;job&gt;_&lt;ts&gt;_&lt;pid&gt;.log</text>
  </g>

  <!-- HDFS logs cloud -->
  <g transform="translate(300,560)" filter="url(#shadow)">
    <use href="#cloud"/>
    <text x="86" y="74" text-anchor="middle" font-family="Inter,Segoe UI,Arial" font-size="14" fill="#1971c2">/user/&lt;os_user&gt;/logs/&lt;job&gt;/</text>
  </g>

  <!-- Arrows between components -->
  <path d="M270,150 L270,310 L360,310" stroke="#343a40" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M570,130 L660,130" stroke="#343a40" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M860,60 L860,90" stroke="#343a40" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M780,200 L740,240" stroke="#343a40" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M940,200 L1000,240" stroke="#343a40" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M1100,420 L1180,500" stroke="#343a40" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M860,420 L860,500" stroke="#343a40" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M500,520 L460,520" stroke="#343a40" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path d="M520,520 L520,500 L820,500" stroke="#343a40" stroke-width="2" fill="none" marker-end="url(#arrow)"/>

  <!-- Legend badges -->
  <g transform="translate(1120,120)">
    <rect x="0" y="0" width="260" height="90" rx="8" fill="#f1f3f5" stroke="#ced4da"/>
    <circle cx="20" cy="22" r="6" fill="#339af0"/><text x="36" y="26" font-family="Inter,Segoe UI,Arial" font-size="14" fill="#343a40">Reads/validation/logging</text>
    <circle cx="20" cy="48" r="6" fill="#ff922b"/><text x="36" y="52" font-family="Inter,Segoe UI,Arial" font-size="14" fill="#343a40">Spark SQL execution</text>
    <circle cx="20" cy="74" r="6" fill="#51cf66"/><text x="36" y="78" font-family="Inter,Segoe UI,Arial" font-size="14" fill="#343a40">Metadata/tables</text>
  </g>
</svg>
